{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/eddie.cm.lam/Desktop/eddie_proj/REdataProj/listingsviewapp/src/App.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useReducer } from \"react\";\nimport XLSX from \"xlsx\";\nimport DataTable from \"./components/DataTable\";\nimport Filters from \"./components/Filters\";\n\nfunction reducer(state, action) {\n  const {\n    type,\n    payload\n  } = action;\n\n  switch (type) {\n    case \"SET_DATAREADY\":\n      return { ...state,\n        dataReady: payload\n      };\n\n    case \"UPDATE_DATA\":\n      return { ...state,\n        data: payload\n      };\n\n    case \"SET_LOADED\":\n      return { ...state,\n        loaded: payload\n      };\n\n    case \"SET_FAIL\":\n      return { ...state,\n        fail: payload\n      };\n\n    case \"SET_MINPRICE\":\n      return { ...state,\n        minPrice: payload\n      };\n\n    case \"SET_MAXPRICE\":\n      return { ...state,\n        maxPrice: payload\n      };\n\n    case \"SET_ESTATE\":\n      return { ...state,\n        estate: payload\n      };\n\n    case \"SET_ERROR\":\n      return { ...state,\n        error: payload\n      };\n\n    case \"ENABLE_ESTATEFILTER\":\n      return { ...state,\n        enableEstateFilter: payload\n      };\n\n    case \"SET_MINFLOOR\":\n      return { ...state,\n        minFloor: payload\n      };\n\n    case \"SET_MAXFLOOR\":\n      return { ...state,\n        maxFloor: payload\n      };\n\n    default:\n      return state;\n  }\n}\n\nfunction App() {\n  _s();\n\n  const initialState = {\n    data: [],\n    loaded: false,\n    fail: false,\n    minPrice: 0,\n    maxPrice: 999999999,\n    minFloor: 0,\n    maxFloor: 99,\n    error: false,\n    estate: \"\",\n    enableEstateFilter: false\n  };\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const {\n    data,\n    loaded,\n    fail,\n    minPrice,\n    maxPrice,\n    minFloor,\n    maxFloor,\n    error,\n    estate,\n    enableEstateFilter\n  } = state;\n  /**\n   * triggered when user uploads a file;\n   * mainly for updating file if need be\n   */\n\n  const readFile = file => {\n    const promise = new Promise((res, rej) => {\n      /* read file */\n      const fileReader = new FileReader();\n      fileReader.readAsArrayBuffer(file);\n\n      fileReader.onload = e => {\n        const arrayBuffer = e.target.result;\n        /* now can read workbook */\n\n        const workbook = XLSX.read(arrayBuffer, {\n          type: \"buffer\"\n        });\n        const worksheetName = workbook.SheetNames[0];\n        const workSheet = workbook.Sheets[worksheetName];\n        const data = XLSX.utils.sheet_to_json(workSheet);\n        res(data);\n      };\n\n      fileReader.onerror = err => rej(err);\n    });\n    promise.then(d => {\n      dispatch({\n        type: \"UPDATE_DATA\",\n        payload: d[0]\n      });\n      dispatch({\n        type: \"SET_LOADED\",\n        payload: true\n      });\n      return;\n    });\n  };\n  /* fetching data and update data state on mount */\n\n\n  useEffect(() => {\n    /* fetch data from ./public/data.json */\n    fetch(\"data.json\", {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(response => {\n      return response.json();\n    }).then(data => {\n      dispatch({\n        type: \"UPDATE_DATA\",\n        payload: data[0]\n      });\n      dispatch({\n        type: \"SET_ESTATE\",\n        payload: data[0][0][\"Estate\"]\n      });\n      dispatch({\n        type: \"SET_LOADED\",\n        payload: true\n      });\n      return;\n    }).catch(err => {\n      dispatch({\n        type: \"SET_LOADED\",\n        payload: true\n      });\n      dispatch({\n        type: \"SET_FAIL\",\n        payload: true\n      });\n      throw err;\n    });\n  }, []);\n  useEffect(() => {\n    Number(maxPrice) <= Number(minPrice) && maxPrice !== \"\" ? dispatch({\n      type: \"SET_ERROR\",\n      payload: \"Price(max) should be greater than Price(min)\"\n    }) : dispatch({\n      type: \"SET_ERROR\",\n      payload: false\n    });\n  }, [maxPrice, minPrice]);\n\n  const handleSetMinPrice = e => {\n    dispatch({\n      type: \"SET_MINPRICE\",\n      payload: e.target.value\n    });\n  };\n\n  const handleSetMaxPrice = e => {\n    dispatch({\n      type: \"SET_MAXPRICE\",\n      payload: e.target.value\n    });\n  };\n\n  const handleSetMinFloor = () => {\n    dispatch({\n      type: 'SET_MINFLOOR',\n      payload: e.target.value\n    });\n  };\n\n  const handleSetMaxFloor = () => {\n    dispatch({\n      type: 'SET_MAXFLOOR',\n      payload: e.target.value\n    });\n  };\n\n  const handleSetEstate = e => {\n    dispatch({\n      type: \"SET_ESTATE\",\n      payload: e.target.value\n    });\n  };\n\n  const handleSetUseEstateFilter = () => {\n    dispatch({\n      type: \"ENABLE_ESTATEFILTER\",\n      payload: !enableEstateFilter\n    });\n  }; // get Estate options\n\n\n  let estateArr = [];\n  data.map(obj => {\n    return estateArr.indexOf(obj.Estate) === -1 && estateArr.push(obj.Estate);\n  }); // get Spec options\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      name: \"XlFileLoader\",\n      id: \"XlFileLoader\",\n      accept: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n      onChange: e => {\n        dispatch({\n          type: \"SET_LOADED\",\n          payload: false\n        });\n        const file = e.target.files[0];\n        readFile(file);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Filters\n    /* filtering price */\n    , {\n      minPrice: minPrice,\n      maxPrice: maxPrice,\n      setMinPriceHandler: handleSetMinPrice,\n      setMaxPriceHandler: handleSetMaxPrice\n      /* filtering floors */\n      ,\n      minFloor: minFloor,\n      maxFloor: maxFloor,\n      setMinFloorHandler: handleSetMinFloor,\n      setMaxFloorHandler: handleSetMaxFloor\n      /* filtering estates */\n      ,\n      enableEstateFilter: enableEstateFilter,\n      estateValue: estate,\n      estateOptions: estateArr,\n      setEstateHandler: handleSetEstate,\n      setEnableEstateFilterHandler: handleSetUseEstateFilter\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }, this), !fail ? loaded ? error ? /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(DataTable, {\n      data: data,\n      minPrice: minPrice,\n      maxPrice: maxPrice,\n      enableEstateFilter: enableEstateFilter,\n      estate: estate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Still loading data...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Failed to fetch data...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 153,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"GUSXxL/WUElrtHc/X73NyHNRMdw=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/eddie.cm.lam/Desktop/eddie_proj/REdataProj/listingsviewapp/src/App.jsx"],"names":["React","useEffect","useReducer","XLSX","DataTable","Filters","reducer","state","action","type","payload","dataReady","data","loaded","fail","minPrice","maxPrice","estate","error","enableEstateFilter","minFloor","maxFloor","App","initialState","dispatch","readFile","file","promise","Promise","res","rej","fileReader","FileReader","readAsArrayBuffer","onload","e","arrayBuffer","target","result","workbook","read","worksheetName","SheetNames","workSheet","Sheets","utils","sheet_to_json","onerror","err","then","d","fetch","headers","response","json","catch","Number","handleSetMinPrice","value","handleSetMaxPrice","handleSetMinFloor","handleSetMaxFloor","handleSetEstate","handleSetUseEstateFilter","estateArr","map","obj","indexOf","Estate","push","files"],"mappings":"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","sourcesContent":["import React, { useEffect, useReducer } from \"react\";\nimport XLSX from \"xlsx\";\nimport DataTable from \"./components/DataTable\";\nimport Filters from \"./components/Filters\";\n\nfunction reducer(state, action) {\n  const { type, payload } = action;\n\n  switch (type) {\n    case \"SET_DATAREADY\":\n      return { ...state, dataReady: payload };\n    case \"UPDATE_DATA\":\n      return { ...state, data: payload };\n    case \"SET_LOADED\":\n      return { ...state, loaded: payload };\n    case \"SET_FAIL\":\n      return { ...state, fail: payload };\n    case \"SET_MINPRICE\":\n      return { ...state, minPrice: payload };\n    case \"SET_MAXPRICE\":\n      return { ...state, maxPrice: payload };\n    case \"SET_ESTATE\":\n      return { ...state, estate: payload };\n    case \"SET_ERROR\":\n      return { ...state, error: payload };\n    case \"ENABLE_ESTATEFILTER\":\n      return {...state, enableEstateFilter: payload}\n    case \"SET_MINFLOOR\":\n      return {...state, minFloor: payload}\n    case \"SET_MAXFLOOR\":\n      return {...state, maxFloor: payload}\n    default:\n      return state;\n  }\n}\n\nfunction App() {\n  const initialState = {\n    data: [],\n    loaded: false,\n    fail: false,\n    minPrice: 0,\n    maxPrice: 999999999,\n    minFloor: 0,\n    maxFloor: 99,\n    error: false,\n    estate: \"\",\n    enableEstateFilter: false,\n  };\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const { data, loaded, fail, minPrice, maxPrice, minFloor, maxFloor,\n    error, estate, enableEstateFilter } = state;\n\n  /**\n   * triggered when user uploads a file;\n   * mainly for updating file if need be\n   */\n  const readFile = (file) => {\n    const promise = new Promise((res, rej) => {\n      /* read file */\n      const fileReader = new FileReader();\n      fileReader.readAsArrayBuffer(file);\n\n      fileReader.onload = (e) => {\n        const arrayBuffer = e.target.result;\n        /* now can read workbook */\n        const workbook = XLSX.read(arrayBuffer, { type: \"buffer\" });\n        const worksheetName = workbook.SheetNames[0];\n        const workSheet = workbook.Sheets[worksheetName];\n        const data = XLSX.utils.sheet_to_json(workSheet);\n        res(data);\n      };\n\n      fileReader.onerror = (err) => rej(err);\n    });\n\n    promise.then((d) => {\n      dispatch({ type: \"UPDATE_DATA\", payload: d[0] });\n      dispatch({ type: \"SET_LOADED\", payload: true });\n      return;\n    });\n  };\n\n  /* fetching data and update data state on mount */\n  useEffect(() => {\n    /* fetch data from ./public/data.json */\n    fetch(\"data.json\", {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        dispatch({ type: \"UPDATE_DATA\", payload: data[0] });\n        dispatch({ type: \"SET_ESTATE\", payload: data[0][0][\"Estate\"] });\n        dispatch({ type: \"SET_LOADED\", payload: true });\n        return;\n      })\n      .catch((err) => {\n        dispatch({ type: \"SET_LOADED\", payload: true });\n        dispatch({ type: \"SET_FAIL\", payload: true });\n        throw err;\n      });\n  }, []);\n\n  useEffect(() => {\n    Number(maxPrice) <= Number(minPrice) && maxPrice !== \"\"\n      ? dispatch({\n          type: \"SET_ERROR\",\n          payload: \"Price(max) should be greater than Price(min)\",\n        })\n      : dispatch({ type: \"SET_ERROR\", payload: false });\n  }, [maxPrice, minPrice]);\n\n  const handleSetMinPrice = (e) => {\n    dispatch({ type: \"SET_MINPRICE\", payload: e.target.value });\n  };\n\n  const handleSetMaxPrice = (e) => {\n    dispatch({ type: \"SET_MAXPRICE\", payload: e.target.value });\n  };\n\n  const handleSetMinFloor = () => {\n    dispatch({type: 'SET_MINFLOOR', payload: e.target.value})\n  }\n\n  const handleSetMaxFloor = () => {\n    dispatch({type: 'SET_MAXFLOOR', payload: e.target.value})\n  }\n\n  const handleSetEstate = (e) => {\n    dispatch({ type: \"SET_ESTATE\", payload: e.target.value });\n  };\n\n  const handleSetUseEstateFilter = () => {\n    dispatch({type: \"ENABLE_ESTATEFILTER\", payload: !enableEstateFilter})\n  }\n\n\n\n  // get Estate options\n  let estateArr = [];\n  data.map((obj) => {\n    return estateArr.indexOf(obj.Estate) === -1 && estateArr.push(obj.Estate);\n  });\n\n  // get Spec options\n\n\n  return (\n    <div className=\"App\">\n      <input\n        type=\"file\"\n        name=\"XlFileLoader\"\n        id=\"XlFileLoader\"\n        accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n        onChange={(e) => {\n          dispatch({ type: \"SET_LOADED\", payload: false });\n          const file = e.target.files[0];\n          readFile(file);\n        }}\n      />\n\n      <Filters\n        /* filtering price */\n        minPrice={minPrice}\n        maxPrice={maxPrice}\n        setMinPriceHandler={handleSetMinPrice}\n        setMaxPriceHandler={handleSetMaxPrice}\n        /* filtering floors */\n        minFloor={minFloor}\n        maxFloor={maxFloor}\n        setMinFloorHandler={handleSetMinFloor}\n        setMaxFloorHandler={handleSetMaxFloor}\n        /* filtering estates */\n        enableEstateFilter={enableEstateFilter}\n        estateValue={estate}\n        estateOptions={estateArr}\n        setEstateHandler={handleSetEstate}\n        setEnableEstateFilterHandler={handleSetUseEstateFilter}\n      />\n\n      {!fail ? (\n        loaded ? (\n          error ? (\n            <h1>{error}</h1>\n          ) : (\n            <DataTable\n              data={data}\n              minPrice={minPrice}\n              maxPrice={maxPrice}\n              enableEstateFilter={enableEstateFilter}\n              estate={estate}\n            />\n          )\n        ) : (\n          <h1>Still loading data...</h1>\n        )\n      ) : (\n        <h1>Failed to fetch data...</h1>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}